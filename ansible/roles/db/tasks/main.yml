---
# tasks file for db
- name: 'Add mongodb repo 4.0'
  yum_repository:
    name: "mongodb"
    description: "MongoDB Repository"
    baseurl: http://downloads-distro.mongodb.org/repo/redhat/os/x86_64/
    gpgcheck: no
    enabled: yes
    file: mongodb
  

- name: 'Install mongodb-org'
  yum:
    name: "{{ packages }}"
  vars:
    packages:
    - mongo-10gen
    - mongo-10gen-server

- name: copy config file
  copy:
    src: mongodb.conf
    dest: /etc/mongodb.conf
    owner: root
    group: root
    mode: 0644
  notify:
    - restart mongodb

- name: Ensure mongodb is running and and enabled to start automatically on reboots
  systemd:
    name: mongodb
    enabled: yes
    state: started

